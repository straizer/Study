<?xml version="1.0"?>
<def>

    <resource>
        <alloc>socket</alloc>
        <alloc>accept</alloc>
        <dealloc>close</dealloc>
    </resource>

    <!-- int shutdown(int sockfd, int how); -->
    <function name="shutdown">
        <arg nr="1">
            <valid>0:</valid>
        </arg>
        <arg nr="2">
            <valid>0:2</valid>
        </arg>
        <use-retval/>
    </function>

    <!-- int inet_pton(int af, const char *src, void *dst); -->
    <function name="inet_pton">
        <leak-ignore/>
        <arg nr="1">
            <valid>0:45</valid>
        </arg>
        <arg nr="2" direction="in">
            <not-null/>
            <not-uninit/>
            <strz/>
        </arg>
        <arg nr="3" direction="out">
            <not-null/>
        </arg>
        <use-retval/>
    </function>

    <!-- const char *inet_ntop(int af, const void *src, char *dst, socklen_t size); -->
    <function name="inet_ntop">
        <leak-ignore/>
        <arg nr="1">
            <valid>0:45</valid>
        </arg>
        <arg nr="2" direction="in">
            <not-null/>
            <not-uninit/>
        </arg>
        <arg nr="3" direction="out">
            <not-null/>
            <minsize type="argvalue" arg="4"/>
        </arg>
        <arg nr="4">
            <valid>0:</valid>
        </arg>
        <use-retval/>
    </function>

    <!-- char *strerror_r (int errnum, char *buf, size_t buflen); -->
    <function name="strerror_r">
        <leak-ignore/>
        <arg nr="1">
            <valid>1:34</valid>
        </arg>
        <arg nr="2" direction="out">
            <not-null/>
            <minsize type="argvalue" arg="3"/>
        </arg>
        <arg nr="3">
            <valid>0:</valid>
        </arg>
    </function>

</def>
